<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>30Hz IMPACT CANNON</title>
    <style>
        body { background: #000; color: #fff; text-align: center; font-family: 'Impact', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .module { border: 5px solid #ff00ff; padding: 50px; background: rgba(255,0,255,0.1); box-shadow: 0 0 50px #ff00ff; }
        .trigger-btn { 
            width: 200px; height: 200px; border-radius: 20px; border: none;
            background: #ff00ff; color: #000; font-size: 3rem; font-weight: bold;
            cursor: pointer; box-shadow: 0 10px 0 #808;
        }
        .trigger-btn:active { transform: translateY(10px); box-shadow: none; filter: brightness(1.5); }
        #status { margin-bottom: 20px; font-size: 1.5rem; color: #ff00ff; text-shadow: 0 0 10px #ff00ff; }
    </style>
</head>
<body>

    <div class="module">
        <div id="status">30Hz PHASE READY</div>
        <button class="trigger-btn" id="fireBtn">爆</button>
    </div>

    <script>
        let audioCtx;
        const btn = document.getElementById('fireBtn');
        const status = document.getElementById('status');

        btn.onclick = () => {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            
            // 30Hzの1周期分(約0.033秒)のバッファを作成
            const sampleRate = audioCtx.sampleRate;
            const periodSamples = Math.floor(sampleRate / 30); 
            const buffer = audioCtx.createBuffer(1, periodSamples, sampleRate);
            const data = buffer.getChannelData(0);

            // 【超・往復動作】
            // 最初の半分(16ms)で最大まで引き込み
            const half = Math.floor(periodSamples / 2);
            for (let i = 0; i < half; i++) {
                data[i] = -1.0; 
            }
            // 後半の半分(16ms)で最大まで突き上げ
            for (let i = half; i < periodSamples; i++) {
                data[i] = 1.0; 
            }

            const source = audioCtx.createBufferSource();
            source.buffer = buffer;
            const gain = audioCtx.createGain();

            // ゲインを限界（さらに倍）まで引き上げ
            gain.gain.setValueAtTime(150.0, audioCtx.currentTime); 

            source.connect(gain);
            gain.connect(audioCtx.destination);

            source.start();

            // 演出
            status.textContent = "IMPACT!!";
            setTimeout(() => { status.textContent = "30Hz PHASE READY"; }, 500);
        };
    </script>
</body>
</html>
