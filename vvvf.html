<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Speaker Vibrator</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding-top: 50px; background: #111; color: #fff; }
        button { padding: 20px 40px; font-size: 20px; cursor: pointer; background: #ff4444; border: none; color: white; border-radius: 10px; }
        input { width: 300px; }
        .controls { margin-top: 30px; }
    </style>
</head>
<body>

    <h1>Speaker Vibrator</h1>
    <p>低周波でスピーカーを物理的に震わせます。</p>
    
    <button id="toggleBtn">再生 / 停止</button>

    <div class="controls">
        <p>周波数: <span id="freqVal">30</span>Hz</p>
        <input type="range" id="freqSlider" min="20" max="100" value="30">
        <p><small>※20Hz〜60Hzが最も震えます</small></p>
    </div>

    <script>
        let audioCtx;
        let oscillator;
        let gainNode;
        let isPlaying = false;

        const toggleBtn = document.getElementById('toggleBtn');
        const freqSlider = document.getElementById('freqSlider');
        const freqVal = document.getElementById('freqVal');

        toggleBtn.addEventListener('click', () => {
            if (!audioCtx) {
                audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            }

            if (!isPlaying) {
                // オシレーター作成
                oscillator = audioCtx.createOscillator();
                gainNode = audioCtx.createGain();

                // 波形の設定（sine = 滑らか, square = 激しい）
                oscillator.type = 'sine'; 
                oscillator.frequency.setValueAtTime(freqSlider.value, audioCtx.currentTime);

                // 音量の設定
                gainNode.gain.setValueAtTime(0.8, audioCtx.currentTime);

                oscillator.connect(gainNode);
                gainNode.connect(audioCtx.destination);

                oscillator.start();
                toggleBtn.textContent = "停止";
                toggleBtn.style.background = "#444";
                isPlaying = true;
            } else {
                oscillator.stop();
                isPlaying = false;
                toggleBtn.textContent = "再生 / 停止";
                toggleBtn.style.background = "#ff4444";
            }
        });

        freqSlider.addEventListener('input', () => {
            const val = freqSlider.value;
            freqVal.textContent = val;
            if (oscillator) {
                oscillator.frequency.setValueAtTime(val, audioCtx.currentTime);
            }
        });
    </script>
</body>
</html>
